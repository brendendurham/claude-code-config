{
  "hooks": {
    "PreToolUse": [
      {
        "matcher": "Write|Edit",
        "hooks": [
          {
            "type": "command",
            "command": "if echo \"$CLAUDE_TOOL_INPUT\" | grep -qiE '(api[_-]?key|password|secret|token|credential)\\s*[=:]\\s*[\"'\\'''][^\"'\\'']+[\"'\\''']'; then echo 'BLOCKED: Potential hardcoded credential detected' >&2; exit 1; fi",
            "timeout": 5000
          }
        ]
      },
      {
        "matcher": "Bash",
        "hooks": [
          {
            "type": "command",
            "command": "if echo \"$CLAUDE_TOOL_INPUT\" | grep -qE '(rm\\s+-rf\\s+/|:(){ :|:& };:|> /dev/sda|mkfs\\.|dd\\s+if=.*of=/dev/)'; then echo 'BLOCKED: Dangerous command pattern' >&2; exit 1; fi",
            "timeout": 5000
          }
        ]
      },
      {
        "matcher": "mcp__*",
        "hooks": [
          {
            "type": "command",
            "command": "mkdir -p \"${HOME}/.claude/logs\" && echo \"[$(date -Iseconds)] MCP: ${CLAUDE_TOOL_NAME}\" >> \"${HOME}/.claude/logs/mcp-audit.log\"",
            "timeout": 3000
          }
        ]
      }
    ],
    "PostToolUse": [
      {
        "matcher": "Edit|Write",
        "hooks": [
          {
            "type": "prompt",
            "prompt": "If this edit involves security-sensitive code (auth, credentials, user input, database queries), flag any concerns."
          }
        ]
      },
      {
        "matcher": "Task",
        "hooks": [
          {
            "type": "command",
            "command": "mkdir -p \"${HOME}/.claude/logs\" && echo \"[$(date -Iseconds)] TASK: ${CLAUDE_TOOL_NAME} exit=${CLAUDE_TOOL_EXIT_CODE:-0}\" >> \"${HOME}/.claude/logs/tasks.log\"",
            "timeout": 3000
          }
        ]
      }
    ],
    "Stop": [
      {
        "matcher": "*",
        "hooks": [
          {
            "type": "prompt",
            "prompt": "Verify all requested tasks are complete before stopping."
          }
        ]
      }
    ],
    "SubagentStop": [
      {
        "matcher": "*",
        "hooks": [
          {
            "type": "prompt",
            "prompt": "Evaluate subagent output for completeness and quality."
          }
        ]
      }
    ],
    "SessionStart": [
      {
        "matcher": "*",
        "hooks": [
          {
            "type": "command",
            "command": "mkdir -p \"${HOME}/.claude/logs\" && echo \"[$(date -Iseconds)] SESSION_START\" >> \"${HOME}/.claude/logs/sessions.log\"; if [ -n \"$CLAUDE_ENV_FILE\" ]; then echo 'export CLAUDE_CONFIG_LOADED=1' >> \"$CLAUDE_ENV_FILE\"; fi",
            "timeout": 5000
          }
        ]
      }
    ]
  }
}
